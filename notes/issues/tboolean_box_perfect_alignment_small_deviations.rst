tboolean_box_perfect_alignment_small_deviations
================================================

dv.py automates the below, but it is rather new : so sanity check manually 


rpost : 14 deviates out of 1.5 M (currently assume compression bin edge effect)
----------------------------------------------------------------------------------

Looked into the 0.0138 rounding issues previously in :doc:`emitconfig-aligned-comparison`

::

    tboolean-;TBOOLEAN_TAG=3 tboolean-box-ip

    In [1]: av = ab.a.rpost_(slice(0,10))

    In [2]: bv = ab.b.rpost_(slice(0,10))

    In [6]: dv = np.abs(av - bv)

    In [8]: dv.max()
    Out[8]: 
    A()sliced
    A(0.013763847773677895)

    In [9]: dv[dv > 0.0001]
    Out[9]: 
    A()sliced
    A([ 0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138,  0.0138])

    In [10]: dv.shape
    Out[10]: (100000, 10, 4)


rpol : perfect match (extreme compression means bigger bins so not unexpected)
---------------------------------------------------------------------------------

::

    In [1]: av = ab.a.rpol_(slice(0,10))

    In [2]: bv = ab.b.rpol_(slice(0,10))

    In [3]: dv = np.abs(av - bv)

    In [4]: dv.shape
    Out[4]: (100000, 3, 4)

    In [5]: dv.max()
    Out[5]: 
    A()sliced
    A(0.0, dtype=float32)


ox : many float precision diffs, a few larger deviates 1e-3 mm (or ns) level scattered around (not a concern)
---------------------------------------------------------------------------------------------------------------

::

    In [3]: av = ab.a.ox[:,:3,:]

    In [4]: bv = ab.b.ox[:,:3,:]

    In [5]: dv = np.abs( av - bv )

    In [6]: dv.max()
    Out[6]: 
    A()sliced
    A(0.000457763671875, dtype=float32)

    In [7]: dv[dv > 0.0001]
    Out[7]: 
    A()sliced
    A([ 0.0001,  0.0001,  0.0001,  0.0002,  0.0001,  0.0002,  0.0001,  0.0001,  0.0002,  0.0002,  0.0002,  0.0003,  0.0002,  0.0002,  0.0001,  0.0001,  0.0001,  0.0001,  0.0002,  0.0001,  0.0005,
            0.0002,  0.0001,  0.0002,  0.0002,  0.0002,  0.0001,  0.0004,  0.0001,  0.0002,  0.0002,  0.0003,  0.0003,  0.0001], dtype=float32)

    In [8]: dv.shape
    Out[8]: (100000, 3, 4)

    In [10]: np.where(dv > 0.0001)[0]
    Out[10]: 
    A()sliced
    A([ 1230,  2413,  9041, 14510, 14747, 14747, 17717, 17968, 17968, 19361, 26635, 30117, 30117, 33262, 36621, 53964, 58609, 58609, 58616, 65630, 65850, 65850, 69653, 69653, 73241, 77962, 77962,
           91760, 91760, 92307, 92353, 92353, 93259, 94891])

    In [11]: pdv = np.where(dv > 0.0001)[0]

::

    In [12]: ab.dumpline(pdv)
          0   1230 :   :                               TO BR SC BT BR BT SA                               TO BR SC BT BR BT SA 
          1   2413 :   :                         TO BT BT SC BT BR BR BT SA                         TO BT BT SC BT BR BR BT SA 
          2   9041 :   :                         TO BT SC BR BR BR BR BT SA                         TO BT SC BR BR BR BR BT SA 
          3  14510 :   :                               TO SC BT BR BR BT SA                               TO SC BT BR BR BT SA 
          4  14747 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
          5  14747 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
          6  17717 :   :                                     TO BT BT SC SA                                     TO BT BT SC SA 
          7  17968 :   :                                     TO BT SC BT SA                                     TO BT SC BT SA 
          8  17968 :   :                                     TO BT SC BT SA                                     TO BT SC BT SA 
          9  19361 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         10  26635 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         11  30117 :   :                                           TO SC SA                                           TO SC SA 
         12  30117 :   :                                           TO SC SA                                           TO SC SA 
         13  33262 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         14  36621 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         15  53964 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         16  58609 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         17  58609 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         18  58616 :   :                                           TO SC SA                                           TO SC SA 
         19  65630 :   :                                           TO SC SA                                           TO SC SA 
         20  65850 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         21  65850 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         22  69653 :   :                               TO BT SC BR BR BT SA                               TO BT SC BR BR BT SA 
         23  69653 :   :                               TO BT SC BR BR BT SA                               TO BT SC BR BR BT SA 
         24  73241 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 
         25  77962 :   :                               TO BT BR SC BR BT SA                               TO BT BR SC BR BT SA 
         26  77962 :   :                               TO BT BR SC BR BT SA                               TO BT BR SC BR BT SA 
         27  91760 :   :                                     TO BT SC BT SA                                     TO BT SC BT SA 
         28  91760 :   :                                     TO BT SC BT SA                                     TO BT SC BT SA 
         29  92307 :   :                                     TO BT BT SC SA                                     TO BT BT SC SA 
         30  92353 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         31  92353 :   :                            TO BT BT SC BT BR BT SA                            TO BT BT SC BT BR BT SA 
         32  93259 :   :                                     TO BT SC BT SA                                     TO BT SC BT SA 
         33  94891 :   :                      TO BT SC BR BR BR BR BR BR BR                      TO BT SC BR BR BR BR BR BR BR 


::

    In [20]: ab.b.ox[pdv,0]
    Out[20]: 
    A()sliced
    A([[-191.6262, -240.3634,  450.    ,    5.566 ],
           [ 185.7708, -133.8457,  450.    ,    7.3141],
           [-450.    , -104.4142,  311.143 ,    9.0581],
           [  83.6955,  208.9171, -450.    ,    5.6188],
           [  32.8972,  150.    ,   24.9922,    7.6757],
           [  32.8972,  150.    ,   24.9922,    7.6757],
           [ 450.    , -186.7449,  310.6051,    5.0707],
           [ 299.2227,  318.1443, -450.    ,    4.8717],
           [ 299.2227,  318.1443, -450.    ,    4.8717],
           [-119.9338,  -93.7702, -100.    ,    8.4226],
           [ -53.6426,   21.8766, -100.    ,    8.2809],
           [-250.0585, -310.6393, -450.    ,    1.616 ],
           [-250.0585, -310.6393, -450.    ,    1.616 ],
           [ 132.5565,  150.    ,   25.6786,    7.1571],
           [-132.3164,  150.    ,  -81.7015,    7.3041],
           [  44.2178,  -85.4901,  100.    ,    8.2882],
           [ 235.1874,  -35.5899, -450.    ,    6.3187],
           [ 235.1874,  -35.5899, -450.    ,    6.3187],
           [ 450.    , -374.7097, -354.1685,    2.6531],
           [ 370.7314, -194.2597, -450.    ,    2.1255],
           [ 450.    ,  331.6871, -351.9688,    6.5555],
           [ 450.    ,  331.6871, -351.9688,    6.5555],
           [-450.    ,  -79.4186,  338.8105,    5.7424],
           [-450.    ,  -79.4186,  338.8105,    5.7424],
           [-150.    , -143.0137,  -25.328 ,   10.0053],
           [-450.    ,    1.9207,  215.8093,    5.7277],
           [-450.    ,    1.9207,  215.8093,    5.7277],
           [-450.    , -333.4134,  224.2618,    4.6566],
           [-450.    , -333.4134,  224.2618,    4.6566],
           [  53.8316, -450.    , -140.0249,    5.9405],
           [ 450.    , -198.9609, -405.3413,    6.8133],
           [ 450.    , -198.9609, -405.3413,    6.8133],
           [ 450.    ,  447.3402, -134.3176,    5.1151],
           [ -85.837 ,   74.2703, -100.    ,    8.7381]], dtype=float32)

    In [21]: ab.a.ox[pdv,0]
    Out[21]: 
    A()sliced
    A([[-191.626 , -240.3634,  450.    ,    5.566 ],
           [ 185.7708, -133.8456,  450.    ,    7.3141],
           [-450.    , -104.4142,  311.1431,    9.0581],
           [  83.6954,  208.9172, -450.    ,    5.6188],
           [  32.8973,  150.    ,   24.992 ,    7.6757],
           [  32.8973,  150.    ,   24.992 ,    7.6757],
           [ 450.    , -186.7451,  310.605 ,    5.0707],
           [ 299.2229,  318.144 , -450.    ,    4.8717],
           [ 299.2229,  318.144 , -450.    ,    4.8717],
           [-119.9337,  -93.7704, -100.    ,    8.4226],
           [ -53.6426,   21.8765, -100.    ,    8.2809],
           [-250.0582, -310.6392, -450.    ,    1.616 ],
           [-250.0582, -310.6392, -450.    ,    1.616 ],
           [ 132.5567,  150.    ,   25.6786,    7.1571],
           [-132.3165,  150.    ,  -81.7016,    7.3041],
           [  44.2179,  -85.4902,  100.    ,    8.2882],
           [ 235.1872,  -35.5898, -450.    ,    6.3187],
           [ 235.1872,  -35.5898, -450.    ,    6.3187],
           [ 450.    , -374.7096, -354.1685,    2.6531],
           [ 370.7314, -194.2595, -450.    ,    2.1255],
           [ 450.    ,  331.6876, -351.969 ,    6.5555],
           [ 450.    ,  331.6876, -351.969 ,    6.5555],
           [-450.    ,  -79.4185,  338.8103,    5.7424],
           [-450.    ,  -79.4185,  338.8103,    5.7424],
           [-150.    , -143.0135,  -25.328 ,   10.0053],
           [-450.    ,    1.9209,  215.8094,    5.7277],
           [-450.    ,    1.9209,  215.8094,    5.7277],
           [-450.    , -333.4131,  224.2616,    4.6566],
           [-450.    , -333.4131,  224.2616,    4.6566],
           [  53.8314, -450.    , -140.0249,    5.9405],
           [ 450.    , -198.9606, -405.3416,    6.8133],
           [ 450.    , -198.9606, -405.3416,    6.8133],
           [ 450.    ,  447.3405, -134.3177,    5.1152],
           [ -85.8371,   74.2702, -100.    ,    8.7381]], dtype=float32)

    In [22]: ab.a.ox[pdv,0] - ab.b.ox[pdv,0]
    Out[22]: 
    A()sliced
    A([[ 0.0001,  0.    ,  0.    ,  0.    ],
           [ 0.    ,  0.0001,  0.    ,  0.    ],
           [ 0.    , -0.0001,  0.0001,  0.    ],
           [-0.0002,  0.0001,  0.    ,  0.    ],
           [ 0.0001,  0.    , -0.0002,  0.    ],
           [ 0.0001,  0.    , -0.0002,  0.    ],
           [ 0.    , -0.0001, -0.    ,  0.    ],
           [ 0.0001, -0.0002,  0.    ,  0.    ],
           [ 0.0001, -0.0002,  0.    ,  0.    ],
           [ 0.0001, -0.0002,  0.    ,  0.    ],
           [-0.    , -0.0002,  0.    ,  0.    ],
           [ 0.0003,  0.0002,  0.    , -0.    ],
           [ 0.0003,  0.0002,  0.    , -0.    ],
           [ 0.0002,  0.    , -0.    ,  0.    ],
           [-0.0001,  0.    , -0.0001, -0.    ],
           [ 0.    , -0.0001,  0.    ,  0.    ],
           [-0.0001,  0.0001,  0.    , -0.    ],
           [-0.0001,  0.0001,  0.    , -0.    ],
           [ 0.    ,  0.0002,  0.    ,  0.    ],
           [-0.0001,  0.0001,  0.    , -0.    ],
           [ 0.    ,  0.0005, -0.0002,  0.    ],
           [ 0.    ,  0.0005, -0.0002,  0.    ],
           [ 0.    ,  0.0001, -0.0002, -0.    ],
           [ 0.    ,  0.0001, -0.0002, -0.    ],
           [ 0.    ,  0.0002, -0.    ,  0.    ],
           [ 0.    ,  0.0002,  0.0001,  0.    ],
           [ 0.    ,  0.0002,  0.0001,  0.    ],
           [-0.    ,  0.0004, -0.0001, -0.    ],
           [-0.    ,  0.0004, -0.0001, -0.    ],
           [-0.0002,  0.    ,  0.    ,  0.    ],
           [ 0.    ,  0.0002, -0.0003,  0.    ],
           [ 0.    ,  0.0002, -0.0003,  0.    ],
           [ 0.    ,  0.0003, -0.0001,  0.    ],
           [-0.0001, -0.0001,  0.    ,  0.    ]], dtype=float32)




