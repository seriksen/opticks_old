Needs reworking for new API when get back into this context.

